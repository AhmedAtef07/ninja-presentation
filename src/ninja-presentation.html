<link rel="import" href="../bower_components/polymer/polymer.html">
<polymer-element name='ninja-presentation' attributes='background font align color'>
    <template>
        <div>
            <content></content>
        </div>
        <style>
            div {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                color: {{color}};
                overflow: hidden;
                background: {{background}};
                font-family: "{{font}}";
                list-style: inside;
                text-align: {{align}};
            }
        </style>
    </template>
    <script>
        var ninjaPresentation = window.ninjaPresentation = {};

        ninjaPresentation.options = {};

        ninjaPresentation.initialize = function () {
            this.slides = document.getElementsByTagName('ninja-slide');
            this.addIdentifierAndHideAllSlides();
            this.setInitialSlide();
            this.addListeners();
        };

        ninjaPresentation.addIdentifierAndHideAllSlides = function () {
            var iterator,
                slidesCount = this.slides.length;
            for (iterator = 0; iterator < slidesCount; iterator++) {
                this.slides[iterator].id = iterator + 1;
                this.slides[iterator].style.opacity = 0;
            }
        };

        ninjaPresentation.setInitialSlide = function () {
            this.focusSlide((this.hasSlideOnLocationHash()) ? this.currentSlide() : 1);
        };

        ninjaPresentation.hasSlideOnLocationHash = function () {
            return !!window.location.hash.substring(window.location.hash.indexOf('#'));
        };

        ninjaPresentation.focusSlide = function (slideIdentifier) {
            document.getElementById(slideIdentifier).style.opacity = 1;
            window.location.hash = slideIdentifier
        };

        ninjaPresentation.hideSlide = function(slideIdentifier) {
            document.getElementById(slideIdentifier).style.opacity = 0;
        };

        ninjaPresentation.currentSlide = function () {
            return window.location.hash.substring(window.location.hash.indexOf('#')+1);
        };

        ninjaPresentation.addListeners = function() {
            document.onkeydown = function (event) {
                ninjaPresentation.controllNavigation(event);
            };
        };

        ninjaPresentation.controllNavigation = function (event) {
            var currentSlide = Number(this.currentSlide());
            switch (event.keyCode) {
                case 32:
                case 39:
                    this.hideSlide(currentSlide);
                    this.focusSlide(currentSlide + 1)
                    break;
                case 37:
                    this.hideSlide(currentSlide);
                    this.focusSlide(currentSlide - 1)
                    break;
            }
        };

        Polymer('ninja-presentation', {
            created: function () {
                ninjaPresentation.initialize();
            },
            background: '#BDC3C7',
            font: 'sans-serif',
            align: 'left',
            color: '#34495E'
        });
    </script>
</polymer-element>

<polymer-element name='ninja-slide' attributes='background font color align'>
    <template>

        <div class='container'>
            <div class='aligner'>
                <content></content>
            <div>
        </div>

        <style>
            .container {
                background: {{background}};
                <template if="{{background == 'nothing'}}">
                    background: none;
                </template>
                position: absolute;
                top: 0;
                left: 0;
                width: 80%;
                height: 100%;
                text-align: {{align}};
                font-family: "{{font}}";
                font-size: 3.5em;
                color: {{color}};
                padding: 0 10%;
                /* -- flex-boxes -- */
                display: -webkit-flex;
                display: flex;
                -webkit-flex-align: center;
                -webkit-align-items: center;
                align-items: center;
            }
            .container .aligner {
                width: 100%;
            }
        </style>

    </template>
    <script>
        Polymer('ninja-slide', {
            align: 'inherit',
            background: 'nothing',
            font: '',
            color: ''
        });
    </script>
</polymer-element>
